{"ast":null,"code":"import _slicedToArray from\"D:/Task1FE/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import classes from\"./Cart.module.css\";import HorizontalCard from\"../Components/UI/HorizontalCard\";import Button from\"../Components/UI/Button\";import{cartActions}from\"../store/index\";import{useLocation,useNavigate}from\"react-router-dom\";import Modal from\"../Components/UI/Modal\";import Loading from\"../Components/Loading\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Cart(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModal=_useState2[0],setshowModal=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setloading=_useState4[1];var navigate=useNavigate();var dispatch=useDispatch();var deleteCart=function deleteCart(){setshowModal(false);dispatch(cartActions.removeCart());};var loggedIn=useSelector(function(state){return state.auth.loggedIn;});var cart=useSelector(function(state){return state.cart.cart;});var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),productList=_useState6[0],setproductList=_useState6[1];useEffect(function(){setloading(true);var cartdata=[];cart.cartList.forEach(function(c){cartdata.push({id:Object.keys(c)[0]});});fetch(\"https://ecommerceio.onrender.com/cartData\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({cart:cartdata})}).then(function(res){return res.json();}).then(function(data){console.log(\"data in cart\",data);setloading(false);setproductList(data.productData);});},[]);useEffect(function(){// setloading(true);\nvar cartdata=[];cart.cartList.forEach(function(c){cartdata.push({id:Object.keys(c)[0]});});var newlist=productList;console.log(\"newlist\",newlist,cartdata);var filtered=newlist.filter(function(ele){for(var x=0;x<cartdata.length;x++){console.log(ele._id,cartdata[x].id);if(cartdata[x].id===ele._id){return true;}}return false;});console.log(\"newlist\",newlist,cartdata,filtered);setproductList(filtered);// fetch(\"https://ecommerceio.onrender.com/cartData\", {\n//   method: \"POST\",\n//   headers: {\n//     \"Content-Type\": \"application/json\",\n//   },\n//   body: JSON.stringify({\n//     cart: cartdata,\n//   }),\n// })\n//   .then((res) => {\n//     return res.json();\n//   })\n//   .then((data) => {\n//     console.log(\"data in cart\", data);\n//     setloading(false);\n//     setproductList(data.productData);\n//   });\n},[cart]);var prevLocation=useLocation();var onBuyHandler=function onBuyHandler(event){event.preventDefault();if(!loggedIn){console.log(prevLocation);navigate(\"/auth?redirectTo=\".concat(prevLocation.pathname));return;}console.log(\"in buy\");fetch(\"https://ecommerceio.onrender.com/create-checkout-session\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({cart:cart})}).then(function(res){return res.json();}).then(function(data){window.location.href=data.url;});};var confirmation=function confirmation(){setshowModal(true);};return/*#__PURE__*/_jsxs(_Fragment,{children:[loading&&/*#__PURE__*/_jsx(Loading,{}),!loading&&productList.length===0&&/*#__PURE__*/_jsxs(\"p\",{className:classes.empty,children:[\"Cart is empty\",/*#__PURE__*/_jsx(\"p\",{className:classes.icon,children:/*#__PURE__*/_jsx(\"ion-icon\",{name:\"sad-outline\"})})]}),!loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[productList.map(function(c){return/*#__PURE__*/_jsx(HorizontalCard,{prod:c});}),productList.length!==0&&/*#__PURE__*/_jsx(Button,{title:\"Buy Now\",onClick:onBuyHandler}),productList.length!==0&&/*#__PURE__*/_jsx(Button,{title:\"Delete Cart\",onClick:confirmation}),showModal&&/*#__PURE__*/_jsx(Modal,{title:\"Confirm!\",message:\"Delete Cart?\",onClick:deleteCart})]})]});}export default Cart;","map":{"version":3,"names":["useEffect","useState","useSelector","useDispatch","classes","HorizontalCard","Button","cartActions","useLocation","useNavigate","Modal","Loading","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","_useState","_useState2","_slicedToArray","showModal","setshowModal","_useState3","_useState4","loading","setloading","navigate","dispatch","deleteCart","removeCart","loggedIn","state","auth","cart","_useState5","_useState6","productList","setproductList","cartdata","cartList","forEach","c","push","id","Object","keys","fetch","method","headers","body","JSON","stringify","then","res","json","data","console","log","productData","newlist","filtered","filter","ele","x","length","_id","prevLocation","onBuyHandler","event","preventDefault","concat","pathname","window","location","href","url","confirmation","children","className","empty","icon","name","map","prod","title","onClick","message"],"sources":["D:/Task1FE/src/pages/Cart.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport classes from \"./Cart.module.css\";\r\nimport HorizontalCard from \"../Components/UI/HorizontalCard\";\r\nimport Button from \"../Components/UI/Button\";\r\nimport { cartActions } from \"../store/index\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport Modal from \"../Components/UI/Modal\";\r\nimport Loading from \"../Components/Loading\";\r\n\r\nfunction Cart() {\r\n  const [showModal, setshowModal] = useState(false);\r\n  const [loading, setloading] = useState(true);\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const deleteCart = () => {\r\n    setshowModal(false);\r\n    dispatch(cartActions.removeCart());\r\n  };\r\n  const loggedIn = useSelector((state) => state.auth.loggedIn);\r\n  const cart = useSelector((state) => state.cart.cart);\r\n  const [productList, setproductList] = useState([]);\r\n  useEffect(() => {\r\n    setloading(true);\r\n    let cartdata = [];\r\n    cart.cartList.forEach((c) => {\r\n      cartdata.push({ id: Object.keys(c)[0] });\r\n    });\r\n\r\n    fetch(\"https://ecommerceio.onrender.com/cartData\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        cart: cartdata,\r\n      }),\r\n    })\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        console.log(\"data in cart\", data);\r\n        setloading(false);\r\n        setproductList(data.productData);\r\n      });\r\n  }, []);\r\n  useEffect(() => {\r\n    // setloading(true);\r\n    let cartdata = [];\r\n    cart.cartList.forEach((c) => {\r\n      cartdata.push({ id: Object.keys(c)[0] });\r\n    });\r\n    const newlist = productList;\r\n    console.log(\"newlist\", newlist, cartdata);\r\n    var filtered = newlist.filter((ele) => {\r\n      for (let x = 0; x < cartdata.length; x++) {\r\n        console.log(ele._id, cartdata[x].id);\r\n        if (cartdata[x].id === ele._id) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    });\r\n    console.log(\"newlist\", newlist, cartdata, filtered);\r\n    setproductList(filtered);\r\n    // fetch(\"https://ecommerceio.onrender.com/cartData\", {\r\n    //   method: \"POST\",\r\n    //   headers: {\r\n    //     \"Content-Type\": \"application/json\",\r\n    //   },\r\n    //   body: JSON.stringify({\r\n    //     cart: cartdata,\r\n    //   }),\r\n    // })\r\n    //   .then((res) => {\r\n    //     return res.json();\r\n    //   })\r\n    //   .then((data) => {\r\n    //     console.log(\"data in cart\", data);\r\n    //     setloading(false);\r\n    //     setproductList(data.productData);\r\n    //   });\r\n  }, [cart]);\r\n  const prevLocation = useLocation();\r\n  const onBuyHandler = (event) => {\r\n    event.preventDefault();\r\n    if (!loggedIn) {\r\n      console.log(prevLocation);\r\n      navigate(`/auth?redirectTo=${prevLocation.pathname}`);\r\n      return;\r\n    }\r\n    console.log(\"in buy\");\r\n    fetch(\"https://ecommerceio.onrender.com/create-checkout-session\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        cart: cart,\r\n      }),\r\n    })\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        window.location.href = data.url;\r\n      });\r\n  };\r\n  const confirmation = () => {\r\n    setshowModal(true);\r\n  };\r\n  return (\r\n    <>\r\n      {loading && <Loading />}\r\n      {!loading && productList.length === 0 && (\r\n        <p className={classes.empty}>\r\n          Cart is empty\r\n          <p className={classes.icon}>\r\n            <ion-icon name=\"sad-outline\"></ion-icon>\r\n          </p>\r\n        </p>\r\n      )}\r\n      {!loading && (\r\n        <div className=\"container\">\r\n          {productList.map((c) => {\r\n            return <HorizontalCard prod={c} />;\r\n          })}\r\n\r\n          {productList.length !== 0 && (\r\n            <Button title=\"Buy Now\" onClick={onBuyHandler} />\r\n          )}\r\n          {productList.length !== 0 && (\r\n            <Button title=\"Delete Cart\" onClick={confirmation} />\r\n          )}\r\n          {showModal && (\r\n            <Modal\r\n              title=\"Confirm!\"\r\n              message=\"Delete Cart?\"\r\n              onClick={deleteCart}\r\n            />\r\n          )}\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Cart;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}