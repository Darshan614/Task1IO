{"ast":null,"code":"import _slicedToArray from\"D:/Task1FE/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{cartActions}from\"../store/index\";import{useLocation,useNavigate}from\"react-router-dom\";import CartComponent from\"../Components/Cart/CartComponent\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Cart(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModal=_useState2[0],setshowModal=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setloading=_useState4[1];var navigate=useNavigate();var dispatch=useDispatch();var deleteCart=function deleteCart(){setshowModal(false);dispatch(cartActions.removeCart());};var loggedIn=useSelector(function(state){return state.auth.loggedIn;});var cart=useSelector(function(state){return state.cart.cart;});var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),productList=_useState6[0],setproductList=_useState6[1];useEffect(function(){setloading(true);var cartdata=[];cart.cartList.forEach(function(c){cartdata.push({id:Object.keys(c)[0]});});fetch(\"https://ecommerceio.onrender.com/cartData\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({cart:cartdata})}).then(function(res){return res.json();}).then(function(data){console.log(\"data in cart\",data);setloading(false);setproductList(data.productData);});},[]);var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),total=_useState8[0],setTotal=_useState8[1];useEffect(function(){// setloading(true);\nvar cartdata=[];cart.cartList.forEach(function(c){cartdata.push({id:Object.keys(c)[0]});});var newlist=productList;console.log(\"newlist1\",newlist,cartdata);var filtered=newlist.filter(function(ele){for(var x=0;x<cartdata.length;x++){console.log(ele._id,cartdata[x].id);if(cartdata[x].id===ele._id){return true;}}return false;});var t=0;for(var a=0;a<filtered.length;a++){t=t+filtered[a].price*Object.values(cart.cartList[a])[0];}console.log(t);setTotal(t);console.log(\"newlist2\",newlist,cartdata,filtered,cart.cartList);setproductList(filtered);},[cart,loading]);var prevLocation=useLocation();var onBuyHandler=function onBuyHandler(event){event.preventDefault();if(!loggedIn){console.log(prevLocation);navigate(\"/auth?redirectTo=\".concat(prevLocation.pathname));return;}console.log(\"in buy\");fetch(\"https://ecommerceio.onrender.com/create-checkout-session\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({cart:cart})}).then(function(res){return res.json();}).then(function(data){window.location.href=data.url;});};var confirmation=function confirmation(){setshowModal(true);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(CartComponent,{loading:loading,productList:productList,onBuyHandler:onBuyHandler,confirmation:confirmation,deleteCart:deleteCart,showModal:showModal,total:total})});}export default Cart;","map":{"version":3,"names":["useEffect","useState","useSelector","useDispatch","cartActions","useLocation","useNavigate","CartComponent","jsx","_jsx","Fragment","_Fragment","Cart","_useState","_useState2","_slicedToArray","showModal","setshowModal","_useState3","_useState4","loading","setloading","navigate","dispatch","deleteCart","removeCart","loggedIn","state","auth","cart","_useState5","_useState6","productList","setproductList","cartdata","cartList","forEach","c","push","id","Object","keys","fetch","method","headers","body","JSON","stringify","then","res","json","data","console","log","productData","_useState7","_useState8","total","setTotal","newlist","filtered","filter","ele","x","length","_id","t","a","price","values","prevLocation","onBuyHandler","event","preventDefault","concat","pathname","window","location","href","url","confirmation","children"],"sources":["D:/Task1FE/src/pages/Cart.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { cartActions } from \"../store/index\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport CartComponent from \"../Components/Cart/CartComponent\";\r\n\r\nfunction Cart() {\r\n  const [showModal, setshowModal] = useState(false);\r\n  const [loading, setloading] = useState(true);\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const deleteCart = () => {\r\n    setshowModal(false);\r\n    dispatch(cartActions.removeCart());\r\n  };\r\n  const loggedIn = useSelector((state) => state.auth.loggedIn);\r\n  const cart = useSelector((state) => state.cart.cart);\r\n  const [productList, setproductList] = useState([]);\r\n  useEffect(() => {\r\n    setloading(true);\r\n    let cartdata = [];\r\n    cart.cartList.forEach((c) => {\r\n      cartdata.push({ id: Object.keys(c)[0] });\r\n    });\r\n\r\n    fetch(\"https://ecommerceio.onrender.com/cartData\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        cart: cartdata,\r\n      }),\r\n    })\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        console.log(\"data in cart\", data);\r\n        setloading(false);\r\n        setproductList(data.productData);\r\n      });\r\n  }, []);\r\n  const [total, setTotal] = useState(0);\r\n  useEffect(() => {\r\n    // setloading(true);\r\n    let cartdata = [];\r\n    cart.cartList.forEach((c) => {\r\n      cartdata.push({ id: Object.keys(c)[0] });\r\n    });\r\n    const newlist = productList;\r\n    console.log(\"newlist1\", newlist, cartdata);\r\n    var filtered = newlist.filter((ele) => {\r\n      for (let x = 0; x < cartdata.length; x++) {\r\n        console.log(ele._id, cartdata[x].id);\r\n        if (cartdata[x].id === ele._id) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    });\r\n    let t = 0;\r\n    for (let a = 0; a < filtered.length; a++) {\r\n      t = t + filtered[a].price * Object.values(cart.cartList[a])[0];\r\n    }\r\n    console.log(t);\r\n    setTotal(t);\r\n    console.log(\"newlist2\", newlist, cartdata, filtered, cart.cartList);\r\n    setproductList(filtered);\r\n  }, [cart, loading]);\r\n  const prevLocation = useLocation();\r\n  const onBuyHandler = (event) => {\r\n    event.preventDefault();\r\n    if (!loggedIn) {\r\n      console.log(prevLocation);\r\n      navigate(`/auth?redirectTo=${prevLocation.pathname}`);\r\n      return;\r\n    }\r\n    console.log(\"in buy\");\r\n    fetch(\"https://ecommerceio.onrender.com/create-checkout-session\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        cart: cart,\r\n      }),\r\n    })\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        window.location.href = data.url;\r\n      });\r\n  };\r\n  const confirmation = () => {\r\n    setshowModal(true);\r\n  };\r\n  return (\r\n    <>\r\n      <CartComponent\r\n        loading={loading}\r\n        productList={productList}\r\n        onBuyHandler={onBuyHandler}\r\n        confirmation={confirmation}\r\n        deleteCart={deleteCart}\r\n        showModal={showModal}\r\n        total={total}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Cart;\r\n"],"mappings":"gGAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,WAAW,KAAQ,gBAAgB,CAC5C,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,MAAO,CAAAC,aAAa,KAAM,kCAAkC,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAE7D,QAAS,CAAAC,IAAIA,CAAA,CAAG,CACd,IAAAC,SAAA,CAAkCZ,QAAQ,CAAC,KAAK,CAAC,CAAAa,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA1CG,SAAS,CAAAF,UAAA,IAAEG,YAAY,CAAAH,UAAA,IAC9B,IAAAI,UAAA,CAA8BjB,QAAQ,CAAC,IAAI,CAAC,CAAAkB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAArCE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAC1B,GAAM,CAAAG,QAAQ,CAAGhB,WAAW,EAAE,CAC9B,GAAM,CAAAiB,QAAQ,CAAGpB,WAAW,EAAE,CAC9B,GAAM,CAAAqB,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,CAAS,CACvBP,YAAY,CAAC,KAAK,CAAC,CACnBM,QAAQ,CAACnB,WAAW,CAACqB,UAAU,EAAE,CAAC,CACpC,CAAC,CACD,GAAM,CAAAC,QAAQ,CAAGxB,WAAW,CAAC,SAACyB,KAAK,QAAK,CAAAA,KAAK,CAACC,IAAI,CAACF,QAAQ,GAAC,CAC5D,GAAM,CAAAG,IAAI,CAAG3B,WAAW,CAAC,SAACyB,KAAK,QAAK,CAAAA,KAAK,CAACE,IAAI,CAACA,IAAI,GAAC,CACpD,IAAAC,UAAA,CAAsC7B,QAAQ,CAAC,EAAE,CAAC,CAAA8B,UAAA,CAAAhB,cAAA,CAAAe,UAAA,IAA3CE,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAClC/B,SAAS,CAAC,UAAM,CACdqB,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,CAAAa,QAAQ,CAAG,EAAE,CACjBL,IAAI,CAACM,QAAQ,CAACC,OAAO,CAAC,SAACC,CAAC,CAAK,CAC3BH,QAAQ,CAACI,IAAI,CAAC,CAAEC,EAAE,CAAEC,MAAM,CAACC,IAAI,CAACJ,CAAC,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CAC1C,CAAC,CAAC,CAEFK,KAAK,CAAC,2CAA2C,CAAE,CACjDC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBlB,IAAI,CAAEK,QACR,CAAC,CACH,CAAC,CAAC,CACCc,IAAI,CAAC,SAACC,GAAG,CAAK,CACb,MAAO,CAAAA,GAAG,CAACC,IAAI,EAAE,CACnB,CAAC,CAAC,CACDF,IAAI,CAAC,SAACG,IAAI,CAAK,CACdC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEF,IAAI,CAAC,CACjC9B,UAAU,CAAC,KAAK,CAAC,CACjBY,cAAc,CAACkB,IAAI,CAACG,WAAW,CAAC,CAClC,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CACN,IAAAC,UAAA,CAA0BtD,QAAQ,CAAC,CAAC,CAAC,CAAAuD,UAAA,CAAAzC,cAAA,CAAAwC,UAAA,IAA9BE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtBxD,SAAS,CAAC,UAAM,CACd;AACA,GAAI,CAAAkC,QAAQ,CAAG,EAAE,CACjBL,IAAI,CAACM,QAAQ,CAACC,OAAO,CAAC,SAACC,CAAC,CAAK,CAC3BH,QAAQ,CAACI,IAAI,CAAC,CAAEC,EAAE,CAAEC,MAAM,CAACC,IAAI,CAACJ,CAAC,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CAC1C,CAAC,CAAC,CACF,GAAM,CAAAsB,OAAO,CAAG3B,WAAW,CAC3BoB,OAAO,CAACC,GAAG,CAAC,UAAU,CAAEM,OAAO,CAAEzB,QAAQ,CAAC,CAC1C,GAAI,CAAA0B,QAAQ,CAAGD,OAAO,CAACE,MAAM,CAAC,SAACC,GAAG,CAAK,CACrC,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAG7B,QAAQ,CAAC8B,MAAM,CAAED,CAAC,EAAE,CAAE,CACxCX,OAAO,CAACC,GAAG,CAACS,GAAG,CAACG,GAAG,CAAE/B,QAAQ,CAAC6B,CAAC,CAAC,CAACxB,EAAE,CAAC,CACpC,GAAIL,QAAQ,CAAC6B,CAAC,CAAC,CAACxB,EAAE,GAAKuB,GAAG,CAACG,GAAG,CAAE,CAC9B,MAAO,KAAI,CACb,CACF,CACA,MAAO,MAAK,CACd,CAAC,CAAC,CACF,GAAI,CAAAC,CAAC,CAAG,CAAC,CACT,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGP,QAAQ,CAACI,MAAM,CAAEG,CAAC,EAAE,CAAE,CACxCD,CAAC,CAAGA,CAAC,CAAGN,QAAQ,CAACO,CAAC,CAAC,CAACC,KAAK,CAAG5B,MAAM,CAAC6B,MAAM,CAACxC,IAAI,CAACM,QAAQ,CAACgC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAChE,CACAf,OAAO,CAACC,GAAG,CAACa,CAAC,CAAC,CACdR,QAAQ,CAACQ,CAAC,CAAC,CACXd,OAAO,CAACC,GAAG,CAAC,UAAU,CAAEM,OAAO,CAAEzB,QAAQ,CAAE0B,QAAQ,CAAE/B,IAAI,CAACM,QAAQ,CAAC,CACnEF,cAAc,CAAC2B,QAAQ,CAAC,CAC1B,CAAC,CAAE,CAAC/B,IAAI,CAAET,OAAO,CAAC,CAAC,CACnB,GAAM,CAAAkD,YAAY,CAAGjE,WAAW,EAAE,CAClC,GAAM,CAAAkE,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIC,KAAK,CAAK,CAC9BA,KAAK,CAACC,cAAc,EAAE,CACtB,GAAI,CAAC/C,QAAQ,CAAE,CACb0B,OAAO,CAACC,GAAG,CAACiB,YAAY,CAAC,CACzBhD,QAAQ,qBAAAoD,MAAA,CAAqBJ,YAAY,CAACK,QAAQ,EAAG,CACrD,OACF,CACAvB,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC,CACrBX,KAAK,CAAC,0DAA0D,CAAE,CAChEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBlB,IAAI,CAAEA,IACR,CAAC,CACH,CAAC,CAAC,CACCmB,IAAI,CAAC,SAACC,GAAG,CAAK,CACb,MAAO,CAAAA,GAAG,CAACC,IAAI,EAAE,CACnB,CAAC,CAAC,CACDF,IAAI,CAAC,SAACG,IAAI,CAAK,CACdyB,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG3B,IAAI,CAAC4B,GAAG,CACjC,CAAC,CAAC,CACN,CAAC,CACD,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,CAAS,CACzB/D,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CACD,mBACER,IAAA,CAAAE,SAAA,EAAAsE,QAAA,cACExE,IAAA,CAACF,aAAa,EACZa,OAAO,CAAEA,OAAQ,CACjBY,WAAW,CAAEA,WAAY,CACzBuC,YAAY,CAAEA,YAAa,CAC3BS,YAAY,CAAEA,YAAa,CAC3BxD,UAAU,CAAEA,UAAW,CACvBR,SAAS,CAAEA,SAAU,CACrByC,KAAK,CAAEA,KAAM,EACb,EACD,CAEP,CAEA,cAAe,CAAA7C,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}